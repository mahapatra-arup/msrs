<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bing Auto Search</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            margin: 0;
            padding: 20px;
            color: #333;
        }

        #div-settings {
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 20px;
            max-width: 400px;
            margin: 0 auto;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        label {
            display: block;
            margin-top: 15px;
            font-weight: bold;
        }

        select,
        button {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-size: 16px;
            background-color: #f9f9f9;
        }

        button {
            background-color: #007bff;
            color: white;
            cursor: pointer;
            margin-top: 20px;
        }

        button:hover {
            background-color: #0056b3;
        }

        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        #span-progress,
        #span-timer,
        #span-countdown {
            display: block;
            text-align: center;
            margin-top: 20px;
            font-size: 18px;
            font-weight: bold;
        }

        h1 {
            text-align: center;
            color: #007bff;
        }
    </style>
</head>

<body>
    <div id="div-settings">
        <label for="slc-limit">Search Limit:</label>
        <select id="slc-limit">
            <option value="20">20</option>
            <option value="30">30</option>
            <option value="35">35</option>
        </select>

        <label for="slc-interval">Search Interval (ms):</label>
        <select id="slc-interval">
            <option value="5000">5 seconds</option>
            <option value="6000">6 seconds</option>
            <option value="7000" selected>7 seconds</option>
            <option value="8000">8 seconds</option>
            <option value="9000">9 seconds</option>
            <option value="10000">10 seconds</option>
            <option value="11000">11 seconds</option>
        </select>

        <label for="slc-multitab">Open in Multiple Tabs:</label>
        <select id="slc-multitab">
            <option value="true">Yes</option>
            <option value="false">No</option>
        </select>

        <label for="slc-waitTime">Wait Time Between Cycles (minutes):</label>
        <select id="slc-waitTime">
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="15">15</option>
            <option value="16">16</option>
            <option value="17">17</option>
        </select>

        <button id="btn-start">Start Search</button>
        <button id="btn-stop" disabled>Stop Search</button>
    </div>

    <span id="span-progress">Total searches performed: 0</span>
    <span id="span-countdown">Next search in: 0 seconds</span>
    <label>Version:2.0</label>

    <script>
        const BING_AUTOSEARCH = {
            elements: {
                button: {
                    start: document.getElementById("btn-start"),
                    stop: document.getElementById("btn-stop")
                },
                select: {
                    limit: document.getElementById("slc-limit"),
                    interval: document.getElementById("slc-interval"),
                    multitab: document.getElementById("slc-multitab"),
                    waitTime: document.getElementById("slc-waitTime")
                },
                span: {
                    progress: document.getElementById("span-progress"),
                    countdown: document.getElementById("span-countdown")
                }
            },
            search: {
                limitCycle: 4,
                limit: 20,
                currentTotalSearches: 0,
                interval: 10000,
                multitab: true,
                intervalId: null,
                countdownId: null,
                previousTab: null, // Track the previous opened tab
                engine: {
                    terms: {
                        lists: [
                            ["After", "conquering", "Lanka,", "Ramachandra", "returned", "to", "Ayodhya", "with", "Sita.", "So", "far", "his", "kingdom", "has", "been", "managed", "by", "brother", "Bharata,", "with", "his", "shoes", "on", "the", "throne", "in", "his", "name.", "Now", "Ram", "is", "his", "possessor.", "Sita", "has", "already", "proved", "her", "chastity", "by", "fire", "test", "but", "is", "allowed", "to", "enter", "the", "palace", "of", "Ayodhya.", "(Short", "Story)", "Another", "four", "months", "passed.", "Sita", "is", "pregnant.", "As", "soon", "as", "he", "found", "out,", "Rama", "ordered", "to", "leave", "Sita", "in", "the", "deep", "forest", "away", "from", "the", "palace.", "It", "is", "Rama", "who,", "in", "an", "effort", "to", "protect", "the", "dignity", "of", "his", "wife,", "kills", "the", "Lankeshwara", "Ravana", "who", "won", "Tribhuvana", "and", "installs", "Vibhishana", "on", "the", "throne", "of", "Lanka", "in", "order", "to", "establish", "justice.", "Rama", "who", "believes", "in", "the", "name", "of", "truth", "should", "do", "everything", "for", "the", "welfare", "of", "the", "people.", "That", "Rama", "left", "him", "for", "the", "subjects", "on", "the", "charge", "of", "Asati.", "Sita", "is", "alone", "in", "Valmiki's", "ashram.", "ashram", "daughter", "Most", "of", "the", "days,", "he", "sits", "on", "the", "banks", "of", "Tamsa", "river", "and", "watches", "his", "own", "shadow", "in", "the", "water.", "That", "shadow", "is", "sometimes", "broken", "little", "by", "little", "by", "the", "vibration", "of", "the", "waves.", "Sometimes", "still,", "as", "if", "sitting", "on", "water"]
                        ]
                    },
                    form: [
                        "QBLH", //Main page textbox suggestion click
                        "QBRE", //Search page textbox suggestion click
                        "HDRSC1", //Search tabmenu click 
                        "LGWQS1", "LGWQS2", "LGWQS3", //Left sidebar suggestion click
                        "R5FD", "R5FD1", "R5FD2", "R5FD3", "R5FD4", "R5FD5", "R5FD6", "R5FD7", //Right sidebar suggestion click
                        "QSRE1", "QSRE2", "QSRE3", "QSRE4", "QSRE5", "QSRE6", "QSRE7", "QSRE8", //Footer suggestion click
                    ],
                    getRandomForm: function () {
                        return this.form[Math.floor(Math.random() * this.form.length)];
                    },
                    getRandomCVID: function () {
                        return 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'.replace(/[x]/g, () => {
                            return (Math.floor(Math.random() * 16)).toString(16).toUpperCase();
                        });
                    }
                },
                // Function to generate a random letter search term (e.g., 3-5 letters)
                generateRandomLetterString: function (length) {
                    const letters = 'abcdefghijklmnopqrstuvwxyz';
                    let result = '';
                    for (let i = 0; i < length; i++) {
                        result += letters.charAt(Math.floor(Math.random() * letters.length));
                    }
                    return result;
                },
                runSearchCycle: function () {
                    let currentSearchCount = 0;

                    this.performSearch();
                    currentSearchCount++;
                    this.currentTotalSearches++;

                    BING_AUTOSEARCH.elements.span.progress.innerText = `Total searches performed: ${this.currentTotalSearches}`;

                    this.updateCountdown(this.interval);

                    this.intervalId = setInterval(() => {
                        if (currentSearchCount >= this.limitCycle || this.currentTotalSearches >= this.limit) {
                            clearInterval(this.intervalId);
                            clearInterval(this.countdownId);
                            if (this.currentTotalSearches < this.limit) {
                                const waitTimeMinutes = parseInt(BING_AUTOSEARCH.elements.select.waitTime.value, 10);
                                const waitTimeMs = waitTimeMinutes * 60 * 1000;

                                setTimeout(() => {
                                    console.log(`Waiting ${waitTimeMinutes} minutes before starting a new search cycle...`);
                                    this.runSearchCycle();
                                }, waitTimeMs);
                            } else {
                                console.log("Total search limit reached. Stopping the process.");
                            }
                        } else {
                            this.performSearch();
                            currentSearchCount++;
                            this.currentTotalSearches++;

                            BING_AUTOSEARCH.elements.span.progress.innerText = `Total searches performed: ${this.currentTotalSearches}`;
                            this.updateCountdown(this.interval);
                        }
                    }, this.interval);
                },
                performSearch: function () {
                    // Generate a random letter string (3-5 letters long)
                    const randomSearchTerm = this.generateRandomLetterString(5);
                    const randomForm = this.engine.getRandomForm();
                    const randomCVID = this.engine.getRandomCVID();

                    // Format the search URL with the random term and form
                    const searchUrl = `https://www.bing.com/search?q=${encodeURIComponent(randomSearchTerm)}&qs=n&form=${randomForm}`; //&cvid=${randomCVID}

                    console.log(`Searching for: ${randomSearchTerm} with FORM=${randomForm} and CVID=${randomCVID}`);

                    // Close previous tab if it exists
                    if (this.previousTab) {
                        this.previousTab.close();
                    }

                    // Open a new tab and keep track of it
                    this.previousTab = window.open(searchUrl, '_blank');

                    // Keep the main window focused
                    window.focus();
                },
                updateCountdown: function (intervalMs) {
                    const countdownDisplay = BING_AUTOSEARCH.elements.span.countdown;
                    let countdownValue = Math.floor(intervalMs / 1000);

                    if (this.countdownId) {
                        clearInterval(this.countdownId);
                    }

                    this.countdownId = setInterval(() => {
                        if (countdownValue <= 0) {
                            clearInterval(this.countdownId);
                            countdownDisplay.innerText = "Next search in: 0 seconds";
                        } else {
                            countdownDisplay.innerText = `Next search in: ${countdownValue} seconds`;
                            countdownValue--;
                        }
                    }, 1000);
                },
                stopSearch: function () {
                    clearInterval(this.intervalId);
                    clearInterval(this.countdownId);
                    console.log("Search process stopped.");
                }
            }
        };

        BING_AUTOSEARCH.elements.button.start.addEventListener("click", function () {
            BING_AUTOSEARCH.search.limit = parseInt(BING_AUTOSEARCH.elements.select.limit.value, 10);
            BING_AUTOSEARCH.search.interval = parseInt(BING_AUTOSEARCH.elements.select.interval.value, 10);
            BING_AUTOSEARCH.search.multitab = BING_AUTOSEARCH.elements.select.multitab.value === "true";
            BING_AUTOSEARCH.search.runSearchCycle();
            BING_AUTOSEARCH.elements.button.start.disabled = true;
            BING_AUTOSEARCH.elements.button.stop.disabled = false;
        });

        BING_AUTOSEARCH.elements.button.stop.addEventListener("click", function () {
            BING_AUTOSEARCH.search.stopSearch();
            BING_AUTOSEARCH.elements.button.start.disabled = false;
            BING_AUTOSEARCH.elements.button.stop.disabled = true;
        });
    </script>

</body>
</html>
